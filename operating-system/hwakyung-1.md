# 운영체제 개념 정리

## 프로세스와 쓰레드

### ✅ 프로세스

- 정의 : 프로그램을 메모리에 올린 동적인 상태로 프로그램이 실행될 때 프로세스 인스턴스가 생성된다고 표현
  - **OS가 프로그램을 메모리에 올리고 CPU를 위한 PCB(Process control block)을 할당한 상태**
- 프로그램 입장 : 프로그램 + PCB
- 스케줄러 입장 : task

### ✅ 쓰레드

- 정의 : CPU에서 처리하는 실행 하나가 스레드
  - 작업 처리 위해 수행하는 **실행** 단위
- CPU는 프로세스로부터 전달받은 스레드 수행
- OS 입장
  - 작업 = 프로세스
  - CPU의 작업 = 프로세스 내의 스레드

### ✅ 프로세스와 쓰레드와의 차이

1. 동시 작업, 시스템 자원을 멀티 스레드가 더 적게 사용
2. 프로세스 간 통신은 스레드 보다 복잡
3. 스레드의 동기화 이슈

- 프로세스 : 메모리에 올라갈 때 운영체제로부터 시스템 자원을 할당 받음

  - 운영체제는 프로세스마다 독립된 메모리 영역을 Code/Data/Stack/Heap 형식을 할당

- 스레드 : 프로세스가 할당받은 메모리 영역 내의 Stack 형식으로 할당된 메모리 영역은 따로 할당받고, 나머지는 code/data/heap 형식으로 할당된 메모리 영역 공유

#### 프로세스와 쓰레드의 작동 방식

- 프로세스 : 독립된 메모리 영역을 할당해 줌 -> 프로세스는 다른 프로세스의 변수나 자료에 접근 x

- 스레드 : 별도의 스택을 가지고 있지만 힙 메모리는 서로 읽고 쓸 수 있음

- 프로세스 실행 중 오류 발생 -> 강제 종료 시 다른 프로세스에게 어떤 영향?
  - 공유하고 있던 파일을 손상시키는 경우가 아니면 영향 X
- 스레드의 경우 메모리 영역의 내용 공유 -> 오류 발생 시 => 다른 스레드도 강제 종료

### 왜 이런 방식으로 메모리 공유?

- 운영체제에게 프로세스는 최소 작업 단위
- 프로세스는 하나 이상의 스레드 보유
- 프로세스가 최소 작업 단위 -> 동일 프로세스 소속의 스레드끼리 메모리를 공유함

### ✅ 프로세스와 쓰레드와의 공통점

### ✅ 기출문제

- Q. 프로세스와 쓰레드의 차이?
  - 프로세스는 독립된 메모리가 할당됨
  - 쓰레드는 별도의 스택이 주어지지만 나머지 힙 메모리는 공유됨
- Q. 프로세스의 문제점
  - 프로세스 생성 시 큰 오버헤드
  - 컨텍스트 스위칭의 비효율성
  - 프로세스 간의 통신이 어려운점
- Q. 쓰레드의 출현 목적
  - 1. 프로세스보다 크기가 작은 실행 단위 필요
  - 2. 빠른 컨텍스트 스위칭
  - 3. 프로세스의 생성 및 소멸에 따른 오버헤드 감소
  - 4. 프로세스들의 통신 시간, 방법 어려움 해소
  - 자원 효율성과 작업 유연성
  - 1. 응답성 향상 : 다른 스레드들이 작업 계속 응답 가능
  - 2. 자원의 공유 : 불필요한 자원 중복 막아짐
  - 3. 다중 CPU 지원 시 멀티 스레드로 처리 가능
- Q. 쓰레드의 주소공간에 대한 설명
  - 쓰레드 동작을 위한 총 6개의 공간
    - 사적 공간
      - 스레드 코드 영역 : 스레드가 실행할 작업의 함수가 있으며 스레드는 프로세스 코드 영역에 있느 ㄴ다른 모든 함수를 호출 할 수 있음
      - 스레드 로컬 스토리지
      - 스레드 사용자 스택 : 프로세스 스택의 일부분을 할당
    - 공유 공간
      - 프로세스에 선언된 함수 코드
      - 데이터 : 개별 스레드 전용 공간인 스레드 로컬 스토리지와 프로세스에 의해 공유되는 변수 공간
      - 힙 : 모든 스레드가 동적 할당을 받는 공간으로 프로세스이 힙 공간 사용
    - 커널 스택
- Q. 멀티 태스킹과 멀티 스레드
  - 멀티 태스킹
    - 하나의 운영체제 안에 여러 프로세스가 실행
  - 멀티 스레드
    - 하나의 프로세스가 여러 스레드를 사용하여 동시 처리
    - 장점
      - 1. context switching 할 때 공유하고 있는 메모리 만큼의 메모리 자원을 아낄 수 있음
      - 2. 스레드는 프로세스 내의 stack 영역을 제외한 모든 메모리 공유 -> 통신의 부담이 적어 응답 시간이 빠름
    - 단점
      - 1. 스레드가 프로세스 자원 망칠 시, 모든 프로세스 종류
      - 2. 자원 공유로 동기화 문제 발생
    - 동기화 문제
      - 전역 변수를 사용할 경우 발생할 수 있는 충돌
      - 프로그래머가 직접 동기화 문제를 대응해야 함
- Q. 다른 프로세스 접근 방법
  - 1. IPC
  - 2. LPC
  - 3. 별도 공유 메모리 생성 및 정보 공유
